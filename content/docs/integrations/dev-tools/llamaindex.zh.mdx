---
title: LlamaIndex
description: 配置 LlamaIndex 使用 NexusGate
icon: Database
---

LlamaIndex 是一个用于构建 LLM 应用的数据框架，提供强大的数据摄取、索引和查询功能。

## 工具简介

- **官方网站**: [llamaindex.ai](https://www.llamaindex.ai/)
- **GitHub**: [run-llama/llama_index](https://github.com/run-llama/llama_index)
- **支持语言**: Python、TypeScript
- **特点**:
  - 数据连接器（100+ 数据源）
  - 高级索引策略
  - 查询引擎
  - 智能体框架

## 配置步骤

### Python

#### 1. 安装依赖

```bash
pip install llama-index llama-index-llms-openai-like
```

#### 2. 初始化 LLM

```python
from llama_index.llms.openai_like import OpenAILike

llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
)

response = llm.complete("你好，今天怎么样？")
print(response.text)
```

将 `YOUR_SERVER_URL` 替换为 <ServerUrl />，将 `YOUR_API_KEY` 替换为 <ApiKeyLink />。

### TypeScript

#### 1. 安装依赖

```bash
npm install llamaindex
```

#### 2. 初始化 LLM

```typescript
import { OpenAI } from "llamaindex";

const llm = new OpenAI({
  model: "gpt-4o",
  apiKey: "YOUR_API_KEY",
  additionalSessionOptions: {
    baseURL: "YOUR_SERVER_URL/v1",
  },
});

const response = await llm.complete({ prompt: "你好！" });
console.log(response.text);
```

## 使用示例

### 文档问答

```python
from llama_index.core import VectorStoreIndex, SimpleDirectoryReader
from llama_index.llms.openai_like import OpenAILike
from llama_index.embeddings.openai import OpenAIEmbedding
from llama_index.core import Settings

# 配置 LLM
Settings.llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
)

# 配置嵌入模型
Settings.embed_model = OpenAIEmbedding(
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
)

# 加载文档并创建索引
documents = SimpleDirectoryReader("./data").load_data()
index = VectorStoreIndex.from_documents(documents)

# 查询
query_engine = index.as_query_engine()
response = query_engine.query("这份文档是关于什么的？")
print(response)
```

### 聊天引擎

```python
from llama_index.core import VectorStoreIndex, SimpleDirectoryReader
from llama_index.llms.openai_like import OpenAILike
from llama_index.core import Settings

Settings.llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
)

documents = SimpleDirectoryReader("./data").load_data()
index = VectorStoreIndex.from_documents(documents)

# 创建带记忆的聊天引擎
chat_engine = index.as_chat_engine(chat_mode="context")

response = chat_engine.chat("介绍一下这些内容")
print(response)

# 追问
response = chat_engine.chat("能详细说明一下吗？")
print(response)
```

### 智能体

```python
from llama_index.core.agent import ReActAgent
from llama_index.llms.openai_like import OpenAILike
from llama_index.core.tools import FunctionTool

llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
)

def multiply(a: int, b: int) -> int:
    """将两个整数相乘。"""
    return a * b

def add(a: int, b: int) -> int:
    """将两个整数相加。"""
    return a + b

tools = [
    FunctionTool.from_defaults(fn=multiply),
    FunctionTool.from_defaults(fn=add),
]

agent = ReActAgent.from_tools(tools, llm=llm, verbose=True)
response = agent.chat("3 * 4 + 5 等于多少？")
print(response)
```

## 高级配置

### 自定义系统提示

```python
from llama_index.llms.openai_like import OpenAILike

llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
    system_prompt="你是一个有帮助的编程助手。",
)
```

### 流式输出

```python
from llama_index.llms.openai_like import OpenAILike

llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
)

response = llm.stream_complete("写一个关于AI的故事")
for chunk in response:
    print(chunk.delta, end="", flush=True)
```

### 自定义参数

```python
llm = OpenAILike(
    model="gpt-4o",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
    temperature=0.7,
    max_tokens=2000,
    timeout=60,
)
```

## 常见问题

### Q: 连接失败？

1. 确认 `api_base` 包含 `/v1`
2. 检查 API Key 是否有效
3. 确保 NexusGate 正在运行

### Q: 嵌入模型报错？

确保嵌入模型通过 NexusGate 可用，或使用本地嵌入模型。

### Q: 如何使用 Claude 模型？

```python
llm = OpenAILike(
    model="claude-sonnet-4-20250514",
    api_base="YOUR_SERVER_URL/v1",
    api_key="YOUR_API_KEY",
    is_chat_model=True,
)
```

## 相关链接

- [LlamaIndex 文档](https://docs.llamaindex.ai/)
- [LlamaIndex GitHub](https://github.com/run-llama/llama_index)
- [NexusGate GitHub](https://github.com/EM-GeekLab/NexusGate)
